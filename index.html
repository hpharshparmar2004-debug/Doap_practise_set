<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>99 MCQ Computer Quiz — 60 minute timer</title>
  <style>
    :root{--bg:#f6f8fb;--card:#ffffff;--accent:#0b6efd;--correct:#d4f8d4;--wrong:#ffd6d6}
    body{font-family:Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);margin:0;padding:24px}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    .meta{margin-left:auto;text-align:right}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(15,23,42,0.06);margin-bottom:16px}
    .timer{font-weight:700;color:#111}
    .question{padding:12px;border-radius:8px;margin-bottom:10px;border:1px solid #eef2f7}
    .qtext{font-weight:600;margin-bottom:8px}
    label.option{display:block;padding:8px;border-radius:6px;border:1px solid transparent;margin:6px 0;cursor:pointer}
    label.option input{margin-right:10px}
    .controls{display:flex;gap:8px;align-items:center}
    button{background:var(--accent);color:#fff;border:0;padding:10px 12px;border-radius:8px;cursor:pointer}
    button.secondary{background:#444;color:#fff}
    .result{padding:12px;border-radius:8px;margin-top:12px}
    .scorebig{font-size:28px;font-weight:800}
    .small{font-size:13px;color:#555}
    .highlight-correct{background:var(--correct)!important;border-color:rgba(34,197,94,0.25)!important}
    .highlight-wrong{background:var(--wrong)!important;border-color:rgba(239,68,68,0.15)!important}
    .fixed-bottom{position:fixed;right:18px;bottom:18px}
    .note{font-size:13px;color:#444}
    .center{text-align:center}
    .hidden{display:none}
    @media (max-width:640px){.container{padding:0 12px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>99 MCQ Computer Quiz</h1>
        <div class="small">Timer: <span id="displayTimer">60:00</span> — Please enter your name and start.</div>
      </div>
      <div class="meta">
        <div class="small">Questions: <strong>99</strong></div>
        <div class="small">Total Marks: <strong>99</strong></div>
      </div>
    </header><div class="card">
  <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
    <input id="studentName" placeholder="Enter student name" style="flex:1;padding:8px;border-radius:8px;border:1px solid #dbe3f0" />
    <div class="controls">
      <button id="startBtn">Start Quiz</button>
      <button id="submitBtn" class="secondary" disabled>Submit</button>
      <button id="downloadCSV" class="secondary hidden">Download CSV</button>
    </div>
  </div>
  <p class="note" style="margin-top:10px">Timer will start when you press <strong>Start Quiz</strong>. When time runs out the quiz auto-submits. After submission you'll see your score and answers will be highlighted (green = correct, red = wrong).</p>
</div>

<form id="quizForm">
  <div id="questionsContainer"></div>
</form>

<div id="resultCard" class="card hidden">
  <div class="center">
    <div class="scorebig" id="scoreText">Score: 0 / 99</div>
    <div class="small" id="percentText">0%</div>
    <div style="margin-top:10px" id="detailText"></div>
    <div style="margin-top:12px"><button id="retryBtn" class="secondary">Retry</button></div>
  </div>
</div>

<div style="height:120px"></div>

  </div>  <script>
    // Questions array (99 items). Each: {q: 'text', options: ['a','b','c','d'], answer: 1} // answer is index 0..3
    const questions = [
      {q:"HTML stands for:",options:["HighText Machine Language","HyperText Markup Language","Hyperlinks Text Mark Language","None"],answer:1},
      {q:"HTTP stands for:",options:["HyperText Transfer Protocol","HighText Transfer Protocol","Hyper Tool Transfer Protocol","None"],answer:0},
      {q:"URL means:",options:["Uniform Resource Locator","Uniform Retrieval Locator","Universal Resource Location","None"],answer:0},
      {q:"IP stands for:",options:["Internet Process","Internet Protocol","Internal Protocol","None"],answer:1},
      {q:"DNS means:",options:["Domain Name Server","Direct Network Service","Domain Naming System","Data Network Service"],answer:0},
      {q:"SMTP stands for:",options:["Simple Mail Transfer Protocol","System Mail Transfer Process","Simple Message Transmission Protocol","None"],answer:0},
      {q:"PDF means:",options:["Portable Document Format","Portable Data File","Public Document File","None"],answer:0},
      {q:"BIOS stands for:",options:["Basic Input Output System","Binary Input Output Service","Basic Integrated Output System","None"],answer:0},
      {q:"VPN means:",options:["Virtual Private Network","Virtual Protocol Network","Variable Private Node","None"],answer:0},
      {q:"AI stands for:",options:["Artificial Intelligence","Automatic Input","Advanced Information","None"],answer:0},
      {q:"SQL means:",options:["Structured Query Language","Simple Query Language","Sequential Query Logic","None"],answer:0},
      {q:"GUI stands for:",options:["Graphical User Interface","General User Interaction","Global User Input","None"],answer:0},
      {q:"USB means:",options:["Universal Serial Bus","Uniform Standard Bus","United Serial Box","None"],answer:0},
      {q:"LAN means:",options:["Local Access Network","Local Area Network","Long Area Node","None"],answer:1},
      {q:"WAN means:",options:["Wide Area Network","World Area Node","Wide Access Network","None"],answer:0},

      {q:"Copy shortcut:",options:["Ctrl+V","Ctrl+C","Ctrl+X","Ctrl+P"],answer:1},
      {q:"Paste shortcut:",options:["Ctrl+C","Ctrl+V","Ctrl+Z","Ctrl+X"],answer:1},
      {q:"Cut shortcut:",options:["Ctrl+X","Ctrl+C","Ctrl+Z","Ctrl+P"],answer:0},
      {q:"Undo shortcut:",options:["Ctrl+X","Ctrl+Z","Ctrl+Y","Ctrl+C"],answer:1},
      {q:"Redo shortcut:",options:["Ctrl+Y","Ctrl+Z","Ctrl+Shift+Y","Ctrl+R"],answer:0},
      {q:"Select All:",options:["Ctrl+A","Ctrl+S","Ctrl+E","Ctrl+D"],answer:0},
      {q:"Find:",options:["Ctrl+H","Ctrl+F","Ctrl+E","Ctrl+G"],answer:1},
      {q:"Replace:",options:["Ctrl+H","Ctrl+F","Ctrl+E","Ctrl+P"],answer:0},
      {q:"Print:",options:["Ctrl+P","Ctrl+S","Ctrl+D","Ctrl+O"],answer:0},
      {q:"Save:",options:["Ctrl+A","Ctrl+S","Ctrl+P","Ctrl+F"],answer:1},
      {q:"New Document:",options:["Ctrl+N","Ctrl+O","Ctrl+Shift+N","Alt+N"],answer:0},
      {q:"Bold:",options:["Ctrl+I","Ctrl+U","Ctrl+B","Ctrl+Shift+B"],answer:2},
      {q:"Italic:",options:["Ctrl+I","Ctrl+U","Ctrl+B","Ctrl+T"],answer:0},
      {q:"Underline:",options:["Ctrl+U","Ctrl+N","Ctrl+Shift+U","Ctrl+Q"],answer:0},
      {q:"New Slide in PPT:",options:["Ctrl+M","Ctrl+Shift+M","Ctrl+N","Alt+M"],answer:0},

      {q:"Notepad is developed by:",options:["Apple","Microsoft","Google","IBM"],answer:1},
      {q:"Notepad files have extension:",options:[".docx",".txt",".rtf",".xls"],answer:1},
      {q:"WordPad supports saving as:",options:["Only .txt",".txt, .rtf, .docx","Only .docx","None"],answer:1},
      {q:"Can Notepad open HTML files?",options:["Yes","No","Only in Windows 10","Only with add-ons"],answer:0},
      {q:"WordPad supports rich text formatting?",options:["Yes","No","Limited","Only in MS Word"],answer:0},
      {q:"Shortcut for new file in Notepad:",options:["Ctrl+N","Ctrl+O","Ctrl+F","Ctrl+M"],answer:0},
      {q:"Can WordPad insert pictures?",options:["Yes","No","Only in Windows 11","Only after update"],answer:0},
      {q:"Notepad is mainly used for:",options:["Simple text editing","Video editing","Spreadsheet work","Drawing"],answer:0},

      {q:"Insert image tag:",options:["<a>","<img>","<pic>","<image>"],answer:1},
      {q:"Hyperlink tag:",options:["<a>","<link>","<href>","<src>"],answer:0},
      {q:"<br> does:",options:["Break line","Bold text","Add row","None"],answer:0},
      {q:"Table row tag:",options:["<tr>","<td>","<th>","<row>"],answer:0},
      {q:"Largest heading tag:",options:["<h6>","<h1>","<head>","<header>"],answer:1},
      {q:"Attribute in <img> for path:",options:["src","href","link","path"],answer:0},
      {q:"Unordered list tag:",options:["<ul>","<ol>","<li>","<list>"],answer:0},
      {q:"Ordered list tag:",options:["<ol>","<ul>","<li>","<order>"],answer:0},
      {q:"Paragraph tag:",options:["<p>","<para>","<pg>","<text>"],answer:0},
      {q:"Line break tag:",options:["<br>","<lb>","<break>","<newline>"],answer:0},

      {q:"Default extension Word 2010:",options:[".doc",".docx",".txt",".pdf"],answer:1},
      {q:"Spell check shortcut:",options:["F7","F2","Ctrl+F7","Shift+F7"],answer:0},
      {q:"Automatic spelling correction:",options:["AutoCorrect","Mail Merge","Track Changes","Find"],answer:0},
      {q:"Mail Merge is used for:",options:["Creating labels and letters","Page setup","Fonts","Hyperlinks"],answer:0},
      {q:"Justify alignment:",options:["Ctrl+J","Ctrl+E","Ctrl+L","Ctrl+R"],answer:0},
      {q:"Page Setup is in:",options:["Layout tab","Insert","View","Review"],answer:0},
      {q:"Default font Word 2010:",options:["Arial","Calibri","Times New Roman","Verdana"],answer:1},
      {q:"Header & Footer option:",options:["Insert","Layout","View","Review"],answer:0},
      {q:"Insert Page Break shortcut:",options:["Ctrl+Enter","Ctrl+Shift+Enter","Alt+Enter","Shift+Enter"],answer:0},
      {q:"Track changes in:",options:["Review tab","Insert","View","References"],answer:0},
      {q:"Insert Table in:",options:["Insert","Layout","Review","Design"],answer:0},
      {q:"Insert Hyperlink shortcut:",options:["Ctrl+K","Ctrl+H","Ctrl+L","Ctrl+Shift+K"],answer:0},

      {q:"Excel 2016 extension:",options:[".xls",".xlsx",".docx",".csv"],answer:1},
      {q:"New worksheet shortcut:",options:["Shift+F11","Ctrl+N","Ctrl+W","Alt+F11"],answer:0},
      {q:"Sum function:",options:["=SUM()","=TOTAL()","=ADD()","=PLUS()"],answer:0},
      {q:"Insert current date:",options:["Ctrl+;","Ctrl+:","Alt+;","Shift+;"],answer:0},
      {q:"Formula symbol:",options:["=","+","-","/"],answer:0},
      {q:"Average function:",options:["=AVG()","=AVERAGE()","=MEAN()","=MIDDLE()"],answer:1},
      {q:"Insert new row shortcut:",options:["Ctrl+Shift++","Ctrl+Enter","Ctrl+Alt++","Shift+Enter"],answer:0},
      {q:"VLOOKUP means:",options:["Vertical Lookup","Variable Lookup","Value Lookup","None"],answer:0},
      {q:"Maximum function:",options:["=MAX()","=LARGE()","=TOP()","=HIGHEST()"],answer:0},
      {q:"Count numbers function:",options:["=COUNT()","=COUNTA()","=COUNTNUM()","=NUMCOUNT()"],answer:0},
      {q:"AutoSum shortcut:",options:["Alt+=","Ctrl=","Shift=","Alt+S"],answer:0},
      {q:"Cell reference is:",options:["Intersection of row & column","Only column name","Only row number","None"],answer:0},
      {q:"Default chart type:",options:["Column Chart","Line Chart","Pie Chart","Bar Chart"],answer:0},
      {q:"Edit active cell:",options:["F2","F4","F7","Shift+F2"],answer:0},
      {q:"Max rows Excel 2016:",options:["1,048,576","65,536","104,857","99,999"],answer:0},

      {q:"PowerPoint 2016 extension:",options:[".ppt",".pptx",".pps",".docx"],answer:1},
      {q:"Start slideshow:",options:["F5","F7","F2","Shift+F5"],answer:0},
      {q:"Slide thumbnail view:",options:["Slide Sorter","Normal","Outline","Notes"],answer:0},
      {q:"Duplicate slide shortcut:",options:["Ctrl+D","Ctrl+Shift+D","Alt+D","F4"],answer:0},
      {q:"Slide Master in:",options:["View tab","Insert","Design","Review"],answer:0},
      {q:"Export slides as images?",options:["Yes","No","Only PDF","Only Word"],answer:0},
      {q:"Insert new slide shortcut:",options:["Ctrl+M","Ctrl+N","Ctrl+Shift+M","Alt+M"],answer:0},
      {q:"Apply animation option:",options:["Animations tab","Design","Insert","Review"],answer:0},

      {q:"Default Access 2016 extension:",options:[".mdb",".accdb",".docx",".dbf"],answer:1},
      {q:"Primary key is:",options:["Unique identifier","Duplicate values","Foreign data","None"],answer:0},
      {q:"Object that stores data:",options:["Table","Form","Query","Report"],answer:0},
      {q:"Data entry object:",options:["Form","Report","Query","Macro"],answer:0},
      {q:"Report generation object:",options:["Report","Form","Table","Module"],answer:0},
      {q:"Query used for retrieving data:",options:["Select Query","Update Query","Delete Query","Append Query"],answer:0},
      {q:"Save object shortcut:",options:["Ctrl+S","Ctrl+Shift+S","F12","Alt+S"],answer:0},
      {q:"Max database size in Access:",options:["2 GB","1 GB","4 GB","Unlimited"],answer:0},

      {q:"Default Paint extension:",options:[".bmp",".jpg",".png",".gif"],answer:0},
      {q:"Tool for line drawing:",options:["Line Tool","Pencil","Shape","Marker"],answer:0},
      {q:"Fill color tool:",options:["Bucket","Brush","Pencil","Eraser"],answer:0},
      {q:"Can Paint crop images?",options:["Yes","No","Only in 3D Paint","Limited"],answer:0},
      {q:"Erase drawing tool:",options:["Eraser","Pencil","Line","Marker"],answer:0},
      {q:"Shape tool available:",options:["Rectangle","Star","Cube","3D"],answer:0},
      {q:"Flip image option in:",options:["Rotate","Resize","Edit","Shapes"],answer:0},
      {q:"Save JPEG in Paint?",options:["Yes","No","Only in Paint 3D","Only in Windows 11"],answer:0}
    ];

    // build questions dynamically
    const container = document.getElementById('questionsContainer');
    questions.forEach((item, idx) => {
      const qDiv = document.createElement('div');
      qDiv.className = 'question';
      qDiv.id = 'q'+idx;
      const qText = document.createElement('div');
      qText.className = 'qtext';
      qText.textContent = (idx+1)+'. '+item.q;
      qDiv.appendChild(qText);

      const optsDiv = document.createElement('div');
      item.options.forEach((opt, i) => {
        const id = 'q'+idx+'o'+i;
        const label = document.createElement('label');
        label.className = 'option';
        label.setAttribute('data-q', idx);
        label.setAttribute('for', id);
        const input = document.createElement('input');
        input.type = 'radio';
        input.name = 'q'+idx;
        input.id = id;
        input.value = i;
        label.appendChild(input);
        const span = document.createElement('span');
        span.innerHTML = opt;
        label.appendChild(span);
        optsDiv.appendChild(label);
      });

      qDiv.appendChild(optsDiv);
      container.appendChild(qDiv);
    });

    // Timer and control logic
    const startBtn = document.getElementById('startBtn');
    const submitBtn = document.getElementById('submitBtn');
    const retryBtn = document.getElementById('retryBtn');
    const downloadCSV = document.getElementById('downloadCSV');
    const displayTimer = document.getElementById('displayTimer');
    const studentNameInput = document.getElementById('studentName');
    const resultCard = document.getElementById('resultCard');
    const scoreText = document.getElementById('scoreText');
    const percentText = document.getElementById('percentText');
    const detailText = document.getElementById('detailText');

    let totalSeconds = 60 * 60; // 60 minutes
    let timerInterval = null;
    let started = false;
    let submitted = false;

    function formatTime(s){
      const mm = Math.floor(s/60).toString().padStart(2,'0');
      const ss = (s%60).toString().padStart(2,'0');
      return mm+':'+ss;
    }

    function startTimer(){
      if(started) return;
      if(!studentNameInput.value.trim()){alert('Please enter student name before starting.');studentNameInput.focus();return}
      started = true;
      submitBtn.disabled = false;
      startBtn.disabled = true;
      timerInterval = setInterval(() => {
        totalSeconds--;
        displayTimer.textContent = formatTime(totalSeconds);
        if(totalSeconds<=0){
          clearInterval(timerInterval);
          if(!submitted) doSubmit(true);
        }
      },1000);
    }

    startBtn.addEventListener('click', startTimer);

    function doSubmit(auto=false){
      if(submitted) return;
      submitted = true;
      clearInterval(timerInterval);
      submitBtn.disabled = true;
      // grading
      let score = 0;
      const wrongDetails = [];
      questions.forEach((q, idx) => {
        const selected = document.querySelector('input[name=q'+idx+']:checked');
        const qEl = document.getElementById('q'+idx);
        // remove previous highlight
        qEl.querySelectorAll('label.option').forEach(l=>{l.classList.remove('highlight-correct');l.classList.remove('highlight-wrong');});
        if(selected){
          const selIndex = Number(selected.value);
          if(selIndex === q.answer){
            score += 1;
            // highlight selected option as correct
            const lab = qEl.querySelector('#q'+idx+'o'+selIndex).parentElement;
            lab.classList.add('highlight-correct');
          } else {
            // mark selected wrong & show correct
            const labSel = qEl.querySelector('#q'+idx+'o'+selIndex).parentElement;
            labSel.classList.add('highlight-wrong');
            const labCorr = qEl.querySelector('#q'+idx+'o'+q.answer).parentElement;
            labCorr.classList.add('highlight-correct');
            wrongDetails.push({n: idx+1, q: q.q, selected: q.options[selIndex], correct: q.options[q.answer]});
          }
        } else {
          // no selection treated as wrong; highlight correct only
          const labCorr = qEl.querySelector('#q'+idx+'o'+q.answer).parentElement;
          labCorr.classList.add('highlight-correct');
          wrongDetails.push({n: idx+1, q: q.q, selected: '(no answer)', correct: q.options[q.answer]});
        }
      });

      // show result
      scoreText.textContent = `Score: ${score} / ${questions.length}`;
      const percent = Math.round((score/questions.length)*100);
      percentText.textContent = `${percent}%`;
      detailText.innerHTML = `<div class="small">Name: <strong>${escapeHtml(studentNameInput.value.trim())}</strong></div><div class="small">Submitted ${auto?"(Auto-submitted) ":""}on: ${new Date().toLocaleString()}</div><div style="margin-top:8px" class="small">Wrong Answers: <strong>${wrongDetails.length}</strong></div>`;
      resultCard.classList.remove('hidden');
      // prepare CSV
      const csv = buildCSV(studentNameInput.value.trim(), score, wrongDetails);
      prepareDownload(csv);
      downloadCSV.classList.remove('hidden');
    }

    function escapeHtml(s){ return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    submitBtn.addEventListener('click', function(e){
      if(!started){alert('Start the quiz first.');return}
      if(!confirm('Are you sure you want to submit?')) return;
      doSubmit(false);
    });

    retryBtn.addEventListener('click', function(){
      if(confirm('Retry will clear all answers and reset timer. Continue?')) location.reload();
    });

    function buildCSV(name, score, wrongDetails){
      const rows = [];
      const now = new Date();
      const iso = now.toISOString();
      // wrong details as a single field with separators
      const wrongStr = wrongDetails.map(w=>`Q${w.n}: ${w.q} || Selected: ${w.selected} || Correct: ${w.correct}`).join(' <=> ');
      rows.push(['Name','Score','DateTime','WrongCount','WrongDetails']);
      rows.push([name, score, iso, wrongDetails.length, wrongStr]);
      return rows.map(r=>r.map(cell=>`"${String(cell).replace(/"/g,'""') }"`).join(',')).join('\n');
    }

    function prepareDownload(csv){
      const blob = new Blob([csv], {type: 'text/csv'});
      const url = URL.createObjectURL(blob);
      downloadCSV.href = url;
      const fname = `${(studentNameInput.value.trim()||'student')}_quiz_${new Date().toISOString().slice(0,19).replace(/[:T]/g,'-')}.csv`;
      downloadCSV.download = fname;
    }

    downloadCSV.addEventListener('click', function(){
      setTimeout(()=>{ // hide after click
        downloadCSV.classList.add('hidden');
      },5000);
    });

    // Auto-save answers locally e
